---
title: "Untitled"
author: "Nadiya Pavlishyn"
date: "11/14/2017"
output: 
  flexdashboard::flex_dashboard:
    orientation: row
  runtime: shiny
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(forcats)
library(tidyverse)
library(dplyr)
library(readr)
library(plotly)
library(janitor)
library(shiny)
library(stringr)

ny_noaa = read_csv("../data/nynoaadat.zip") %>%
  clean_names %>%
  separate(date, into = c("year", "month","day"), sep = "-") %>%
  filter(year >= 2000) %>%
  drop_na(prcp) %>%
  arrange(year, month, day) %>%
  select(id, year, month, day, prcp) %>%
  mutate(year = as.factor(year), date = str_c(month, day, sep = ".")) %>%
  select(-month, -day) %>%
  group_by(year, date) %>%
  mutate(prcp = mean(prcp)) %>%
  ungroup()
  

```

```{r, echo = FALSE}
which_year = ny_noaa %>% distinct(year) %>% pull()


# selectInput widget
selectInput("year_choice", label = h3("Select year"),
            choices = which_year, selected = "2010")

renderPlotly({
    ny_noaa %>%
    filter(year == input$year_choice) %>%
    plot_ly(x = ~date, y = ~prcp, type = "scatter",
          alpha = 0.5,
          color = ~prcp)
})

```