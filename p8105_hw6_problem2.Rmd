---
title: "Untitled"
author: "Nadiya Pavlishyn"
date: "11/14/2017"
output: 
  flexdashboard::flex_dashboard:
    orientation: row
  runtime: shiny
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(forcats)
library(tidyverse)
library(dplyr)
library(readr)
library(plotly)
library(janitor)
library(shiny)

ny_noaa = read_csv("../data/nynoaadat.zip") %>%
  clean_names %>%
  separate(date, into = c("year", "month","day"), sep = "-") %>%
  filter(year >= 2000) %>%
  drop_na(prcp) %>%
  select(year, month, day, prcp) %>%
  mutate(month = as.numeric(month), day = as.numeric(day), year = as.factor(year))
  

```

```{r, echo = FALSE}
which_year = ny_noaa %>% distinct(year) %>% pull()


# selectInput widget
selectInput("year_choice", label = h3("Select year"),
            choices = which_year, selected = "2010")

renderPlotly({
    ny_noaa %>%
    filter(year == input$year_choice) %>%
    plot_ly(x = ~month, y = ~prcp, type = "scatter", mode = "points",
          alpha = 0.5,
          color = ~day)
})

```